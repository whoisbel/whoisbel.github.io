"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6391],{3722:function(t,e,s){s.r(e);class a{constructor(){this.config={rootMargin:"100px 0px",threshold:.01,endpoint:"/api/catalog/featured",retryAttempts:3,retryDelay:1e3},this.loadingItems=new Set,this.observer=new IntersectionObserver((t=>this.handleIntersection(t)),{rootMargin:this.config.rootMargin,threshold:this.config.threshold}),this.observeFeaturedItems()}observeFeaturedItems(){document.querySelectorAll(".catalog-featured-item").forEach((t=>{t.dataset.loaded||this.loadingItems.has(t)||this.observer.observe(t)}))}handleIntersection(t){t.forEach((t=>{t.isIntersecting&&!t.target.dataset.loaded&&this.loadFeaturedContent(t.target)}))}async loadFeaturedContent(t){if(!t.dataset.loaded&&!this.loadingItems.has(t)){this.loadingItems.add(t);try{const e=t.dataset.featuredContext;t.dataset.featuredPosition;if(!e)throw new Error("Missing featured context data");const s=JSON.parse(e);t.classList.add("is-loading");const a=await this.fetchContentWithRetry(s,t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const r=await a.text();t.innerHTML=r,t.dataset.loaded="true",t.classList.remove("is-loading"),t.classList.add("is-loaded"),this.observer.unobserve(t),this.initializeDeferredImages(t)}catch(e){this.handleLoadError(t,e)}finally{this.loadingItems.delete(t)}}}async fetchContentWithRetry(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;try{return await fetch(this.config.endpoint,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({context:t})})}catch(a){if(s<this.config.retryAttempts){const a=this.config.retryDelay*Math.pow(2,s-1);return await new Promise((t=>setTimeout(t,a))),this.fetchContentWithRetry(t,e,s+1)}throw a}}handleLoadError(t,e){t.classList.remove("is-loading"),t.remove(),this.loadingItems.delete(t);try{this.observer.unobserve(t)}catch(t){}}initializeDeferredImages(t){t.querySelectorAll("img[data-src]").forEach((t=>{t.dataset.src&&(t.src=t.dataset.src,t.removeAttribute("data-src"))}))}destroy(){this.observer.disconnect(),this.loadingItems.clear()}}let r=null;e.default=t=>{switch(t.name){case"load:FEATUREDCONTENT_MODULE":r=new a;break;case"request:COURSES/LIST_PAGE_SUCCESS":case"load:IMAGES":r&&setTimeout((()=>{r.observeFeaturedItems()}),100)}}}}]);